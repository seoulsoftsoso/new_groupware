<!DOCTYPE html>
<html>
<header>{% include "header.html" %}</header>

<body style="overflow: hidden;">
<!-- {#{% extends 'index.html' %}#} -->
{% load static %}
{{ cu.media }}
<!-- {##}
{#{% block title %}#}
{#    <title>거래처 기준정보관리</title>#}
{#{% endblock title %}#}

{#{% block content %}#} -->

<!-- 검색 -->
<div class="card m-2">
    <div class="card-body p-2">
        <!-- 본문 -->
        <div
                class="content-search row no-gutters align-items-center content-input-group"
        >
            <div class="content-title col-1 align-self-stretch">검색</div>
            <div class="col-11">
                <div class="row no-gutters">
                    <div class="content-input-group col-3 px-0">
                        <div class="content-input-group-header">
                            <label>거래구분</label>
                        </div>
                        <div
                                class="input-group"
                                id="customer_type_search"
                        >
                            {{ cu.cu_division_sch }}

                            {#                            <select#}
                            {#                                    name="customer_division"#}
                            {#                                    class="form-control"#}
                            {#                                    id="customer_search1"#}
                            {#                            ></select>#}

                        </div>
                    </div>
                    <div class="content-input-group col-3 px-0">
                        <div class="content-input-group-header">
                            <label>거래처 명</label>
                        </div>
                        <div
                                class="input-group"
                                id="customer_name_search"
                        >
                            {{ cu.cu_name_sch }}
                            {#                            <select#}
                            {#                                    name="customer_name"#}
                            {#                                    class="form-control"#}
                            {#                                    id="customer_search2"#}
                            {#                            ></select>#}
                        </div>
                    </div>
                    <div class="col-1 px-0">
                        <button
                                class="btn button-search rounded-0 w-100 h-100"
                                onclick="search_click()"
                        >
                            검색
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- 내용 -->
<div class="card m-2">
    <div class="row no-gutters card-body p-2">
        <!-- 본문 -->
        <form id="detail_customer" class="content-content w-100">
            <!-- TODO: submit 시 validation 구현 -->
            {% csrf_token %}
            <div class="row no-gutters w-100 mb-2">
                <div class="col-1 content-title">내용</div>
                <div class="col-11">
                    <div class="row no-gutters">
                        <div class="content-input-group col-3">
                            <div class="content-input-group-header">
                                <label>거래처코드<strong>*</strong></label>
                            </div>
                            <div class="content-input-group-input">
                                <input class="form-control" name="customer_code"/>
                            </div>
                        </div>
                        <div class="content-input-group col-3">
                            <div class="content-input-group-header">
                                <label>거래처명<strong>*</strong></label>
                            </div>
                            <div class="content-input-group-input">
                                <input class="form-control" name="customer_name"/>
                            </div>
                        </div>

                        <div class="content-input-group col-3">
                            <div class="content-input-group-header">
                                <label>사업자번호<strong>*</strong></label>
                            </div>
                            <div class="content-input-group-input">
                                <input class="form-control" name="licensee_number"/>
                            </div>
                        </div>
                        <div class="content-input-group col-3">
                            <div class="content-input-group-header">
                                <label>대표자명</label>
                            </div>
                            <div class="content-input-group-input">
                                <input class="form-control" name="customer_owner_name"/>
                            </div>
                        </div>
                    </div>
                    <div class="row no-gutters">
                        <div class="content-input-group col-3">
                            <div class="content-input-group-header">
                                <label>업태</label>
                            </div>
                            <div class="content-input-group-input">
                                <input class="form-control" name="business_conditions"/>
                            </div>
                        </div>
                        <div class="content-input-group col-3">
                            <div class="content-input-group-header">
                                <label>종목</label>
                            </div>
                            <div class="content-input-group-input">
                                <input class="form-control" name="business_event"/>
                            </div>
                        </div>
                        <div class="content-input-group col-2">
                            <div class="content-input-group-header">
                                <label>우편번호</label>
                            </div>
                            <div class="content-input-group-input">
                                <input class="form-control" name="office_post_code"/>
                            </div>
                        </div>
                        <div class="content-input-group col-4">
                            <div class="content-input-group-header">
                                <label>주소</label>
                            </div>
                            <div class="content-input-group-input">
                                <input class="form-control" name="office_address"/>
                            </div>
                        </div>
                    </div>
                    <div class="row no-gutters">
                        <div class="content-input-group col-3">
                            <div class="content-input-group-header">
                                <label>전화번호</label>
                            </div>
                            <div class="content-input-group-input">
                                <input class="form-control" name="office_phone"/>
                            </div>
                        </div>
                        <div class="content-input-group col-3">
                            <div class="content-input-group-header">
                                <label>팩스번호</label>
                            </div>
                            <div class="content-input-group-input">
                                <input class="form-control" name="office_fax_number"/>
                            </div>
                        </div>
                        <div class="content-input-group col-2">
                            <div class="content-input-group-header">
                                <label>담당자</label>
                            </div>
                            <div class="content-input-group-input">
                                <input class="form-control" name="person_in_charge"/>
                            </div>
                        </div>
                        <div class="content-input-group col-4">
                            <div class="content-input-group-header">
                                <label>직급</label>
                            </div>
                            <div class="content-input-group-input">
                                <input class="form-control" name="charge_level"/>
                            </div>
                        </div>
                        <div class="content-input-group col-3">
                            <div class="content-input-group-header">
                                <label>담당자 연락처</label>
                            </div>
                            <div class="content-input-group-input">
                                <input class="form-control" name="charge_phone"/>
                            </div>
                        </div>
                        <div class="content-input-group col-3">
                            <div class="content-input-group-header">
                                <label>E-mail</label>
                            </div>
                            <div class="content-input-group-input">
                                <input class="form-control" name="email"/>
                            </div>
                        </div>
                        <div class="content-input-group col-2">
                            <div class="content-input-group-header">
                                <label>거래구분</label>
                            </div>
                            <div class="input-group">
                                <!--
                                <select
                                        class="form-control h-100"
                                        name="customer_division"
                                ></select>
                                -->
                                {{ cu.cu_division_add }}
                            </div>
                        </div>
                        <div class="content-input-group col-4">
                            <div class="content-input-group-header col-2">
                                <label>비고</label>
                            </div>
                            <div class="content-input-group-input col-10">
                                <input class="form-control" name="customer_note"/>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row no-gutters w-100 mt-3 justify-content-end">
                    <div class="col-1 px-0 mr-2">
                        <button
                                type="button"
                                class="btn button-custom2 w-100"
                                onclick="document.getElementById('file-selector').click();"
                        >
                            엑셀 업로드
                        </button>
                        <input
                                type="file"
                                id="file-selector"
                                style="display: none"
                                accept=".xlsx, .xls"
                        />
                    </div>
                    <div class="col-1 px-0 mr-2">
                        <button
                                class="btn button-custom2 w-100"
                                type="button"
                                onclick="customer_refresh();"
                        >
                            초기화
                        </button>
                    </div>

                    <div class="col-1 px-0 mr-2">
                        <button class="btn button-custom2 w-100 add" type="button" onclick="customer_add()">
                            추가
                        </button>
                    </div>
                    <div class="col-1 px-0 mr-2">
                        <button
                                class="btn button-custom2 w-100"
                                type="button"
                                onclick="customer_edit();"
                        >
                            수정
                        </button>
                    </div>
                    <div class="col-1 px-0">
                        <button
                                class="btn button-custom2 w-100"
                                type="button"
                                onclick="customer_remove();"
                        >
                            삭제
                        </button>
                    </div>
                </div>
            </div>
        </form>
    </div>
</div>

<!-- 테이블 -->
<div class="card m-2">
    <div class="row no-gutters card-body p-2">
        <!-- 본문 -->
        <div class="content-table col-12" style="overflow-y: hidden; height:420px;">
            <table
                    id="customer_data-table"
                    class="table table-sm text-center"
                    style="min-width: 1300px"
            >
                <thead>
                <tr>
                    <th>순번</th>
                    <th>거래처코드</th>
                    <th>거래처명</th>
                    <th>거래구분</th>
                    <th>사업자번호</th>
                    <th>대표자명</th>
                    <th>업태</th>
                    <th>종목</th>
                    <th>우편번호</th>
                    <th>주소</th>
                    <th>회사전화번호</th>
                    <th>팩스번호</th>
                    <th>담당자</th>
                    <th>직급</th>
                    <th>담당자 연락처</th>
                    <th>E-mail</th>
                    {#                    <th>사용구분</th>#}
                    <th>비고</th>
                    <th>등록자</th>
                    <th>등록일</th>
                    <th>최종변경자</th>
                    <th>최종변경일</th>
                </tr>
                </thead>
                <tbody id="customer_tbody"></tbody>
            </table>

            <div class="row no-gutters d-flex justify-content-center" id="customer_nation"
                 style="margin-top: -20px;">
            </div>
        </div>
    </div>
</div>
<!-- 테이블 -->

<!-- 모달  -->
<div class="modal fade" id="checkModal" data-backdrop="static" data-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" >관리자 비밀번호 입력</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <form>
          <div class="mb-3">
            <label for="recipient-name" class="col-form-label">비밀번호를 입력후 수정해 주세요</label>
            <input type="password" class="form-control" id="check_auth">
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">닫기</button>
        <button type="button" class="btn btn-primary" id="modal_check_but" onclick="check_click()" >확인</button>
      </div>
    </div>
  </div>
</div>

<script src="{% static 'js/api_customer.js' %}" type="text/javascript"></script>
<script src="{% static 'js/api_codemaster.js' %}" type="text/javascript"></script>
<script src="{% static 'js/api_paginations.js' %}" type="text/javascript"></script>
<script>
    // 검색인자
    let cu_division_sch = null;
    let cu_name_sch = null;

    // add 항목
    let cu_click_division_id = null;
    let cu_click_division_name = null;

    let customer_id;
    let customer_name;
    let page1_size = 10;

    let nation_data1 = {
        cname: 'nation1',  // 인스턴스 명과 일치해야함
        table_id: 'customer_nation',
        range: 5,
        page_size: page1_size,
    };

    let nation1 = new Pnations(nation_data1, search); // 인스턴스 명

    $(function () {
        main();
    });

    function main() {
        search();
    }

    // 이거 있어야 되나???
    window.onkeydown = function (event) {
        if (event.keyCode == 116) {  // F5
            event.returnValue = false;
            refresh();
        }
    }

    function refresh() {
        location.href = "/basic_information/customers/";
    }

    function search_click() {
        nation1.page = 1;

        cu_division_sch = $('#id_cu_division_sch').val();
        cu_name_sch = $('#id_cu_name_sch').val();

        search();
    }

    function search() {
        let query = "?page_size=" + page1_size + "&page=" + nation1.page;

        if (cu_division_sch == '' || cu_division_sch == null || cu_division_sch == '선택') {
        } else {
            query += "&cu_division_sch=" + cu_division_sch;
        }
        if (cu_name_sch == '' || cu_name_sch == null || cu_name_sch == '선택') {
        } else {
            query += "&cu_name_sch=" + cu_name_sch;
        }

        loading_start();
        api_gp("/basic_information/customers_read/" + query, "get", {}, (done) => {
            loading_finish()
            draw_customers_table(done);
        });

        // for file upload
        const fileSelector = document.getElementById("file-selector");
        fileSelector.addEventListener("change", (event) => {
            let form = new FormData();
            let file = (fileSelector.files[0] ? fileSelector.files[0] : null);

            form.append("csrfmiddlewaretoken", '{{ csrf_token }}')
            form.append("excel", file)

            api_excel_upload(form, () => {
                alert("성공적으로 등록하였습니다.");

                refresh_data();
            });
        });
    }

    function draw_customers_table(done) {

        let data = done.results;
        let num = (((nation1.page * 1) - 1) * nation_data1["page_size"]) + 1;
        let rows = "";
        for (let i = 0; i < data.length; i++) {
            let item = data[i];
            let created_date = item.created_at;
            let updated_date = item.updated_at;
            if (item.customer_code != 0) {
                // append it
                let row = "<tr id='" + item.id + "' style='cursor:pointer;'>";
                row += "<td>" + (num + i) + "</td>";
                row += "<td name='customer_code'>" + item.code + "</td>";
                row += "<td name='customer_name'>" + item.name + "</td>";
                row +=
                    "<td name='customer_division' property='" +
                    (item.division_id ? item.division_id : "") +
                    "'>" +
                    (item.division_name ? item.division_name : "") +
                    "</td>";
                row +=
                    "<td name='licensee_number'>" + (item.licensee_number ? item.licensee_number : '') + "</td>";
                row +=
                    "<td name='customer_owner_name'>" + (item.owner_name ? item.owner_name : '') + "</td>";
                row +=
                    "<td name='business_conditions'>" +
                    (item.business_conditions ? item.business_conditions : "") +
                    "</td>";
                row +=
                    "<td name='business_event'>" +
                    (item.business_event ? item.business_event : "") +
                    "</td>";
                row +=
                    "<td name='office_post_code'>" +
                    (item.postal_code ? item.postal_code : "") +
                    "</td>";
                row +=
                    "<td name='office_address'>" +
                    (item.address ? item.address : "") +
                    "</td>";
                row +=
                    "<td name='office_phone'>" +
                    (item.office_phone ? item.office_phone : "") +
                    "</td>";
                row +=
                    "<td name='office_fax_number'>" +
                    (item.office_fax ? item.office_fax : "") +
                    "</td>";
                row +=
                    "<td name='person_in_charge'>" +
                    (item.charge_name ? item.charge_name : "") +
                    "</td>";
                row +=
                    "<td name='charge_level'>" +
                    (item.charge_level ? item.charge_level : "") +
                    "</td>";
                row +=
                    "<td name='charge_phone'>" +
                    (item.charge_phone ? item.charge_phone : "") +
                    "</td>";
                row +=
                    "<td name='email'>" + (item.email ? item.email : "") + "</td>";
                {% comment %}row +=
                    "<td name='customer_use_division'>" +
                    (item.enable ? "사용" : "미사용") +
                    "</td>";{% endcomment %}
                row +=
                    "<td name='customer_note'>" +
                    (item.etc ? item.etc : "") +
                    "</td>";
                row += "<td name='created_by'>" + item.created_by + "</td>";
                row +=
                    "<td name='created_at'>" +
                    created_date.substring(0, 4) +
                    "-" +
                    created_date.substring(5, 7) +
                    "-" +
                    created_date.substring(8, 10) +
                    "</td>";
                row += "<td name='updated_by'>" + item.updated_by + "</td>";
                row +=
                    "<td name='updated_at'>" +
                    updated_date.substring(0, 4) +
                    "-" +
                    updated_date.substring(5, 7) +
                    "-" +
                    updated_date.substring(8, 10) +
                    "</td>";

                row += "</tr>";

                rows += row;
            }
        }

        nation1.nation_display(done);
        $('#customer_tbody').html(rows);

        // 클릭한 행 유지하게끔...
        if (customer_id != null) {
            $("#" + customer_id).addClass('clicked');
        }

        $('#customer_tbody > tr').on('click', function () {
            customer_id = $(this).attr("id");
            customer_name = $(this).find("[name='customer_name']").text();

            cu_click_division_id = $(this).find("[name='customer_division']").attr("property")
            cu_click_division_name = $(this).find("[name='customer_division']").text();

            $("#detail_customer [name='customer_code']").val(
                $(this).find("[name='customer_code']").text()
            );
            $("#detail_customer [name='customer_name']").val(
                $(this).find("[name='customer_name']").text()
            );

            // add 항목중에 거래구분
            let option1 = new Option(cu_click_division_name, cu_click_division_id, true, true);
            $('#id_cu_division_add').append(option1).trigger('change');

            /*
            $("#detail_customer [name='customer_division']")
                .val($(this).find("[name='customer_division']").attr("property"))
                .trigger("change");
             */

            $("#detail_customer [name='licensee_number']").val(
                $(this).find("[name='licensee_number']").text()
            );
            $("#detail_customer [name='customer_owner_name']").val(
                $(this).find("[name='customer_owner_name']").text()
            );
            $("#detail_customer [name='business_conditions']").val(
                $(this).find("[name='business_conditions']").text()
            );
            $("#detail_customer [name='business_event']").val(
                $(this).find("[name='business_event']").text()
            );
            $("#detail_customer [name='office_post_code']").val(
                $(this).find("[name='office_post_code']").text()
            );
            $("#detail_customer [name='office_address']").val(
                $(this).find("[name='office_address']").text()
            );
            $("#detail_customer [name='office_phone']").val(
                $(this).find("[name='office_phone']").text()
            );
            $("#detail_customer [name='office_fax_number']").val(
                $(this).find("[name='office_fax_number']").text()
            );
            $("#detail_customer [name='person_in_charge']").val(
                $(this).find("[name='person_in_charge']").text()
            );
            $("#detail_customer [name='charge_level']").val(
                $(this).find("[name='charge_level']").text()
            );
            $("#detail_customer [name='charge_phone']").val(
                $(this).find("[name='charge_phone']").text()
            );
            $("#detail_customer [name='email']").val(
                $(this).find("[name='email']").text()
            );
            $("#detail_customer [name='customer_use_division']").val(
                $(this).find("[name='customer_use_division']").text()
            );
            $("#detail_customer [name='customer_note']").val(
                $(this).find("[name='customer_note']").text()
            );

            // table click highlight
            $(this).parent().find('tr').removeClass('clicked');
            $(this).addClass('clicked');
        });
    }


    $('#detail_customer [name="business_event"]').keydown(function (e) {
        let code = e.keyCode || e.which;
        if (code === 9) {
            addrPostCodeFinder(
                document.querySelector(
                    '#detail_customer [name="office_post_code"]'
                ),
                document.querySelector('#detail_customer [name="office_address"]')
            );
        }
    });
    $('#detail_customer [name="office_post_code"]').on("click", function () {
        addrPostCodeFinder(
            document.querySelector('#detail_customer [name="office_post_code"]'),
            document.querySelector('#detail_customer [name="office_address"]')
        );
    });


    // validation Test Code
    function validationTest(el) {
        let valid = true;
        $(el)
            .find("input")
            .each(function () {
                //            console.log($(this).attr('name') + ' : ' + $(this).parent().prev().find('strong').length);
                let now = $(this);
                if ($(this).parent().prev().find("strong").length) {
                    if (now.val() == "") {
                        now.css({border: "1px solid red"});
                        valid = false;
                        //                    console.log('validation false');
                    } else {
                        now.css({border: "1px solid green"});
                        //                    console.log('validation true');
                    }
                }
            });

        $(el)
            .find("select")
            .each(function () {
                //            console.log($(this).attr('name') + ' : ' + $(this).parent().prev().find('strong').length);
                let now = $(this);
                if ($(this).parent().prev().find("strong").length) {
                    if (now.val() == "선택") {
                        if (now.attr("aria-hidden")) {
                            // check select2
                            now.next().css({border: "1px solid red"});
                        }
                        now.css({border: "1px solid red"});
                        valid = false;
                        //                    console.log('validation false');
                    } else {
                        if (now.attr("aria-hidden")) {
                            // check select2
                            now.next().css({border: "1px solid green"});
                        }
                        now.css({border: "1px solid green"});
                        //                    console.log('validation true');
                    }
                }
            });

        return valid;
    }


    function customer_add() {
        if ($("#detail_customer [name='customer_code']").val() == "") {
            alert("거래처코드를 입력해 주세요.");
            return;
        }
        if ($("#detail_customer [name='customer_name']").val() == "") {
            alert("거래처명을 입력해 주세요.");
            return;
        }
        if ($("#detail_customer [name='licensee_number']").val() == "") {
            alert("사업자번호를 입력해 주세요.");
            return;
        }

        let allData = get_data();
        api_gp('/basic_information/customers_create/', 'post', allData, (done) => {

            nation1.page = 1;
            customer_id = done.id;
            // if 걸어서 정상적으로 추가 된 경우에만 추가 되었다 뜨게끔...
            alert("추가되었습니다.");

            search();
        });
    }

    function customer_edit() {
        if (customer_id == null) {
            alert("테이블에서 항목을 먼저 선택하십시오.");
        } else {

            if ($("#detail_customer [name='customer_code']").val() == "") {
                alert("거래처코드를 입력해 주세요.");
                return;
            }
            if ($("#detail_customer [name='customer_name']").val() == "") {
                alert("거래처명을 입력해 주세요.");
                return;
            }
            if ($("#detail_customer [name='licensee_number']").val() == "") {
                alert("사업자번호를 입력해 주세요.");
                return;
            }



            if(get_cookie('enterprise_id')=="54"){
                $('#modal_check_but').attr("value", "edit")
                $('#checkModal').modal('show');
            }else{
                update_customers();
            }



        }
    }

    function check_click(){
        let tname = $('#modal_check_but').attr('value');

        if(get_cookie('snd_auth')!=$('#check_auth').val()){
            alert('정확한 비밀번호를 입력해주세요')
        }else{
            if(tname=="edit"){
                update_customers();

            }else{
                delete_customers();

            }

            $('#check_auth').val('')

            $('#checkModal').modal('hide');

        }
    }

    function update_customers(){
         let allData = get_data();

            api_gp('/basic_information/customers_update/', 'post', allData, (done) => {
                //nation1.page = 1;
                alert("수정되었습니다.");

                search();
            });
    }


    function customer_remove() {

        if (customer_id == null) {
            alert("거래처를 먼저 선택하십시오.");
        } else {
            if(get_cookie('enterprise_id')=="54"){
                $('#modal_check_but').attr("value", "del");
                $('#checkModal').modal('show');
            }else{
                delete_customers();
            }


        }
    }

    function delete_customers(){
        let allData = {
            csrfmiddlewaretoken: '{{ csrf_token }}',
            pk: customer_id,  // pk
        }

        var del = confirm(
                "거래처: " + customer_name + "을(를) 삭제 하시겠습니까?"
            );

            if (del) {
                api_gp('/basic_information/customers_delete/', 'post', allData, () => {
                    alert("삭제하였습니다.");
                    nation1.page = 1;

                    search();
                });
            }
    }

    function get_data() {
        let customer_code = $('#detail_customer [name="customer_code"]').val();
        let customer_name = $('#detail_customer [name="customer_name"]').val();

        let customer_division_code = $('#id_cu_division_add').val();
        let customer_division = customer_division_code;

        let licensee_number = $(
            '#detail_customer [name="licensee_number"]'
        ).val();
        let customer_owner_name = $(
            '#detail_customer [name="customer_owner_name"]'
        ).val();
        let business_conditions = $(
            '#detail_customer [name="business_conditions"]'
        ).val();
        let business_event = $(
            '#detail_customer [name="business_event"]'
        ).val();
        let office_post_code = $(
            '#detail_customer [name="office_post_code"]'
        ).val();
        let office_address = $(
            '#detail_customer [name="office_address"]'
        ).val();
        let office_phone = $('#detail_customer [name="office_phone"]').val();
        let office_fax_number = $(
            '#detail_customer [name="office_fax_number"]'
        ).val();
        let person_in_charge = $(
            '#detail_customer [name="person_in_charge"]'
        ).val();
        let charge_level = $('#detail_customer [name="charge_level"]').val();
        let charge_phone = $('#detail_customer [name="charge_phone"]').val();
        let email = $('#detail_customer [name="email"]').val();
        let customer_use_division =
            $('#detail_customer [name="customer_use_division"]').val() == "사용";
        let customer_note = $('#detail_customer [name="customer_note"]').val();

        return {
            csrfmiddlewaretoken: '{{ csrf_token }}',
            pk: customer_id,

            code: customer_code,
            name: customer_name,
            division: customer_division,
            licensee_number: licensee_number,
            owner_name: customer_owner_name,
            business_conditions: business_conditions,
            business_event: business_event,
            postal_code: office_post_code,
            address: office_address,
            office_phone: office_phone,
            office_fax: office_fax_number,
            charge_name: person_in_charge,
            charge_level: charge_level,
            charge_phone: charge_phone,
            email: email,
            {#enable: customer_use_division,#}
            etc: customer_note,
        };
    }

    // Table export
    $(parent.document).find("#excel-export").click(() =>
        init_excel_export($("#customer_data-table"), "거래처기준정보")
    );

    function customer_refresh() {
        $("[name='customer_code']").val("");  // 거래처코드
        $("[name='customer_name']").val("");  // 거래처명
        $("[name='licensee_number']").val("");  // 사업자번호
        $("[name='customer_owner_name']").val("");  // 대표자명
        $("[name='business_conditions']").val("");  // 업태
        $("[name='business_event']").val("");  // 종목
        $("[name='office_post_code']").val("");  // 우편번호
        $("[name='office_address']").val("");  // 주소
        $("[name='office_phone']").val("");  // 전화번호
        $("[name='office_fax_number']").val("");  // 팩스번호
        $("[name='person_in_charge']").val("");  // 담당자
        $("[name='charge_level']").val("");  // 직급
        $("[name='charge_phone']").val("");  // 담당자 연락처
        $("[name='email']").val("");  // E-mail

        let option1 = new Option('', '', true, true);
        $('#id_cu_division_add').append(option1).trigger('change');

        //$("[name='customer_division']").val(null).trigger("change");  // 거래구분
        $("[name='customer_note']").val("");  // 비고

        $('#customer_tbody').find('tr').removeClass('clicked');

        //search();

    }
    function api_excel_upload(allData, done_callback) {
        let v = allData.values();

        for (let value of v){
            console.log(value);
        }

        $.ajax({
            type: "POST",
            url: "/basic_information/customers_excel/",
            headers: {
                "Authorization": get_token()
            },
            processData: false,
            contentType: false,
            data: allData
        })
            .done(function () {
                done_callback();
            })
            .fail(handle_error);
    }

</script>
<!-- {#{% endblock %}#} -->
</body>
</html>
