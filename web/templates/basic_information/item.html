<!DOCTYPE html>
<html>
<header>{% include "header.html" %}</header>
<body style="overflow: hidden;">
{% load static %}
{{ it.media }}
{#<title>í’ˆëª© ê¸°ì¤€ì •ë³´ê´€ë¦¬</title>#}

<div class="col-12">
    <div class="main-content">
        <div class="main-content-inner">
            <!-- ê²€ìƒ‰  -->
            <div class="row align-items-center">
                <div class="col-lg-12 col-ml-12 mt-3">
                    <div class="card">

                            <div class="row ml-3">
                                <div class="col-md-3 clearfix">
                                    <div class="form-group">
                                        <label for="example-text-input" class="col-form-label">í’ˆë²ˆ</label>
                                        <div class="content-input-group-input">
                                        {{ it.it_code_sch }}
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-3 clearfix">
                                    <div class="form-group">
                                        <label for="example-text-input" class="col-form-label">í’ˆëª…</label>
                                        <div class="content-input-group-input">
                                         {{ it.it_name_sch }}
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-3 clearfix">
                                    <div class="form-group">
                                        <label for="example-text-input" class="col-form-label">ìì¬ë¶„ë¥˜</label>
                                        <div class="content-input-group-input">
                                         {{ it.it_division_sch }}
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-1 clearfix">
                    <div class="gradient-buttons ml-1 col-md-3 mt-3">
                        <button type="button" class="btn btn-primary" onclick="search_click();"><i class="ti-search"></i>  ê²€ìƒ‰</button>
                    </div>
                </div>
                <div class="col-md-1 mt-4">
                    <ul class="notification-area pull-right">
                        <li class="settings-btn">
                            <i class="ti-settings"></i>
                        </li>
                    </ul>
                </div>
                            </div>

                    </div>
                </div>
                </div>
            </div>
            <!-- í…Œì´ë¸”  -->
            <div class="row no-gutters ml-4 mr-4">

                    <div class="card">
                        <div class="card-body" style="width: 100%">

                            <table id="item_table" class="table table-hover table-striped table-bordered display nowrap" style="width: 100%; table-layout: fixed;">
                                <thead>
                                    <tr>
                                        <th>ìˆœë²ˆ</th>
                                        <th>í’ˆë²ˆ</th>
                                        <th>í’ˆëª…</th>
                                        <th>í’ˆëª…ìƒì„¸</th>
                                        <th>ëª¨ë¸</th>
                                        <th class="d-none">ëª¨ë¸ì•„ì´ë””</th>
                                        <th>ìì¬ë¶„ë¥˜</th>
                                        <th class="d-none">ìì¬ë¶„ë¥˜ì•„ì´ë””</th>
                                        <th>ë‹¨ìœ„</th>
                                        <th class="d-none">ë‹¨ìœ„ì•„ì´ë””</th>
                                        <th>ê±°ë˜ì²˜</th>
                                        <th class="d-none">ê±°ë˜ì²˜ì•„ì´ë””</th>
                                        <th>MOQ</th>
                                        <th>ì•ˆì „ì¬ê³ ìˆ˜ëŸ‰</th>
                                        <th>ë¹„ê³ </th>
                                        <th>í‘œì¤€ë‹¨ê°€</th>
                                        <th>ìˆ˜ìˆ˜ë£Œìœ¨</th>
                                        <th>TYPE</th>
                                        <th class="d-none"></th>
                                        <th class="d-none"></th>
                                    </tr>
                                </thead>
                                <tbody id="item_tbody"></tbody>

                            </table>

                        </div>
                    </div>

            </div>
        </div>
    </div>
</div>
<!-- ê²€ìƒ‰ -->
<div class="card m-2">
    <div class="card-body p-2">
        <!-- ë³¸ë¬¸ -->
        <div
                class="content-search row no-gutters align-items-center content-input-group"
        >
            <div class="content-title col-1 align-self-stretch">ê²€ìƒ‰</div>

                        <div class="content-input-group col-4 mt-2">
                            <div class="content-input-group-input input-group">
                                <input class="form-control" id="multiSearch" placeholder="ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”
                                "/>
                              <div class="input-group-append">
                         <button class="btn btn-outline-secondary" type="button" onclick="nation1.page =1; search();"> ğŸ”</button>

                            </div>
                            </div>
                        </div>

        </div>
    </div>
</div>

<!-- offset area start -->
<div class="offset-area">
    <div class="offset-close"><i class="ti-close"></i></div>
    <ul class="nav offset-menu-tab">
        <li><a class="active" data-toggle="tab" href="#detail_item">í¸ì§‘</a></li>
        <li></li>
    </ul>
    <div class="offset-content tab-content">
        <div id="detail_item" class="tab-pane fade in show active">
            <div class="col-12">
                <div class="card">
                    <div class="card-body">
                        <form class="needs-validation" id="item_master_form">
                            <div class="form-row">
                                <div class="col-md-6 mb-3">
                                    <label for=""><strong>*</strong>í’ˆë²ˆ</label>
                                    <input type="text" class="form-control form-control-sm" name="item_master_code" autocomplete="off"/>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label for=""><strong>*</strong>í’ˆëª…</label>
                                    <input type="text" class="form-control form-control-sm" name="item_master_name" autocomplete="off"/>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label for="">í’ˆëª…ìƒì„¸</label>
                                    <input type="text" class="form-control form-control-sm" name="item_master_detail" autocomplete="off"/>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label for="">ìì¬ë¶„ë¥˜</label>
                                    <div>
                                    {{ it.it_division_add }}
                                    </div>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label for="">ëª¨ë¸</label>
                                    <div>
                                    {{ it.it_model_add }}
                                    </div>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label for="">ë‹¨ìœ„</label>
                                    <div>
                                    {{ it.it_unit_add }}
                                    </div>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label for="">ê±°ë˜ì²˜</label>
                                    <div>
                                    {{ it.it_customer_add }}
                                    </div>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label for="">MOQ</label>
                                    <input type="text" class="form-control form-control-sm" name="item_master_moq" autocomplete="off"/>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label for="">í‘œì¤€ë‹¨ê°€</label>
                                    <input type="text" class="form-control form-control-sm" name="item_master_standard_price" autocomplete="off"/>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label for="">ìˆ˜ìˆ˜ë£Œìœ¨</label>
                                    <input type="text" class="form-control form-control-sm" name="item_master_fee_rate" autocomplete="off"/>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label for="">ì•ˆì „ì¬ê³ ìˆ˜ëŸ‰</label>
                                    <input type="text" class="form-control form-control-sm" name="item_master_safe_amount" autocomplete="off"/>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label for="">ë¹„ê³ </label>
                                    <input type="text" class="form-control form-control-sm" name="item_master_etc" autocomplete="off"/>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label for="">QR</label>
                                    <div>
                                    <input type="button"  class="btn btn-secondary form-control form-control-sm" id="qr" onclick="show_qr_print($(this).val())"/>
                                    </div>
                                </div>

                            </div>
                        </form>
                        <div class="gradient-buttons pull-right">
                            <div class="btn btn-primary mr-3" onclick="qr_update()"> QRìƒì„± </div>
                            <div class="btn btn-primary mr-3" onclick="refresh_data()"> ì´ˆê¸°í™” </div>
                            <div class="btn btn-primary mr-3" id="item_add-sm-4"> ë“± ë¡ </div>
                            <div class="btn btn-primary mr-3" id="item_edit-sm-4"> ìˆ˜ ì • </div>
                            <div class="btn btn-primary mr-3" id="item_delete-sm-4"> ì‚­ ì œ </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>



<script src="{% static 'js/api_codemaster.js' %}" type="text/javascript"></script>
<script src="{% static 'js/api_item.js' %}" type="text/javascript"></script>
<script src="{% static 'js/api_BOMmaster.js' %}" type="text/javascript"></script>
<script src="{% static 'js/api_paginations.js' %}" type="text/javascript"></script>
<script src="{% static 'srtdash/assets/js/scripts.js' %}" type="text/javascript"></script>

<script>
    let main_table = null;
    // ê²€ìƒ‰ì¸ì - í’ˆë²ˆ, í’ˆëª…, ìì¬ë¶„ë¥˜(ac)
    let it_code_sch = null;
    let it_nice_number_sch = null;
    let it_brand_sch = null;
    let it_item_group_sch = null;
    let it_division_sch = null;

    // add í•­ëª© - ìì¬ë¶„ë¥˜, ëª¨ë¸, ë‹¨ìœ„, ê±°ë˜ì²˜, ìš©ê¸°íƒ€ì…, ì¹¼ë¼êµ¬ë¶„, í’ˆì¢…êµ¬ë¶„ë¶„
    let it_click_div_id = null;
    let it_click_div_name = null;

    let it_click_model_id = null;
    let it_click_model_name = null;

    let it_click_unit_id = null;
    let it_click_unit_name = null;

    let it_click_cu_id = null;
    let it_click_cu_name = null;

    let it_click_con_id = null;
    let it_click_con_name = null;

    let it_click_color_id = null;
    let it_click_color_name = null;

    let it_click_kind_id = null;
    let it_click_kind_name = null;

    let it_click_brand_id = null;
    let it_click_brand_name = null;

    let it_click_item_group_id = null;
    let it_click_item_group_name = null;

    let it_click_purchase_from_id = null;
    let it_click_purchase_from_name = null;
    let it_click_purchase_from_code = null;

    let it_click_purchase_from2_id = null;
    let it_click_purchase_from2_name = null;
    let it_click_purchase_from2_code = null;

    let it_click_purchase_from3_id = null;
    let it_click_purchase_from3_name = null;
    let it_click_purchase_from3_code = null;

    // ì•„ì´í…œ pk
    let item_id_idx = null;
    let item_name = null;

    let item_qr_path = null;

    let page1_size = 10000;

    let nation_data1 = {
        cname: 'nation1',  // ì¸ìŠ¤í„´ìŠ¤ ëª…ê³¼ ì¼ì¹˜í•´ì•¼í•¨
        table_id: 'item_nation',
        range: 5,
        page_size: page1_size,
    };

    let nation1 = new Pnations(nation_data1, search);  // ì¸ìŠ¤í„´ìŠ¤ ëª…

    $(function () {
        main_table = $('#item_table').DataTable({
                "columnDefs": [
                  {
                    "targets": [1, 2, 3, 10], // ëª¨ë¸ì•„ì´ë””
                    render: function(data, type, row, meta) {
                          return type === 'display' ? '<span title="' + data + '">' + data + '</span>' : data;
                        }
                  },{
                    "targets": [5], // ëª¨ë¸ì•„ì´ë””
                    "visible": false, // ì»¬ëŸ¼ ìˆ¨ê¹€
                    "searchable": false // ìˆ¨ê¸´ ì»¬ëŸ¼ì— ëŒ€í•œ ê²€ìƒ‰ ë¹„í™œì„±í™” (ì„ íƒ ì‚¬í•­)
                  },{
                    "targets": [7], // ìì¬ë¶„ë¥˜
                    "visible": false,
                    "searchable": false
                  },{
                    "targets": [9], // ë‹¨ìœ„
                    "visible": false,
                    "searchable": false
                  },{
                    "targets": [11], // ê±°ë˜ì²˜
                    "visible": false,
                    "searchable": false
                  },{
                    "targets": [15], // í‘œì¤€ë‹¨ê°€
                    render: function(data, type, row) {
                        if (type === 'display' && typeof data === 'number') {
                          return 'â‚©' + data.toFixed(0).replace(/(\d)(?=(\d{3})+(?!\d))/g, '$1,');
                        }
                        return data;
                      }
                  },{
                    "targets": [18], // í’ˆëª©ì•„ì´ë””
                    "visible": false,
                    "searchable": false
                  },
                    {
                    "targets": [19], // QR
                    "visible": false,
                    "searchable": false
                  },
                    {
                    "targets": "_all",
                    "className": "ellipsis"
                  }
                ]
            })

        // ë²„íŠ¼ í™œì„±í™”
        $("#item_add-sm-4").prop('disabled', false).attr("class","btn btn-primary mr-3").on('click', function (){item_add()})

        $("#item_edit-sm-4").prop('disabled', true).attr("class","btn btn-primary mr-3 disabled").off('click')
        $("#item_delete-sm-4").prop('disabled', true).attr("class","btn btn-primary mr-3 disabled").off('click')

        search();
        //refresh();
        // Table export
    });

    function excel_upload() {
        let form = new FormData();

        let fileSelector = document.getElementById('excel');
        let file = (fileSelector.files[0] ? fileSelector.files[0] : null);

        form.append("csrfmiddlewaretoken", '{{ csrf_token }}')
        form.append("excel", file)

        api_excel_upload(form, () => {
            alert("ì„±ê³µì ìœ¼ë¡œ ë“±ë¡í•˜ì˜€ìŠµë‹ˆë‹¤.");

            refresh_data();
        });
    }

    function api_excel_upload(allData, done_callback) {
        let v = allData.values();

        for (let value of v){
            console.log(value);
        }

        $.ajax({
            type: "POST",
            url: "/basic_informations/items/excelupload/",
            headers: {
                "Authorization": get_token()
            },
            processData: false,
            contentType: false,
            data: allData
        })
            .done(function () {
                done_callback();
            })
            .fail(handle_error);
    }

    function refresh() {
        location.href = "/basic_information/items/";
    }

    {% comment %}
    function refresh() {
        init_drop_down();
        item_search();
    }
    {% endcomment %}

    function search_click() {
        nation1.page = 1;

        it_code_sch = $('#id_it_code_sch').val();
        it_nice_number_sch = $('#id_it_nice_number_sch').val();
        it_brand_sch = $('#id_it_brand_sch').val();
        it_item_group_sch = $('#id_it_item_group_sch').val();
        it_division_sch = $('#id_it_division_sch').val();

        search();
    }

    let order = ""

    function search(ordering) {

        if (ordering === '' || ordering === null || ordering=== undefined ){
        } else {
              order === ordering ? order = "-" +ordering : order = ordering
        }

        let query = "?page_size=" + page1_size + "&page=" + nation1.page +"&";

        query += "ordering=" + order + "&";

        if (it_code_sch == '' || it_code_sch == null || it_code_sch == 'ì„ íƒ ë° ê²€ìƒ‰') {
        } else {
            query += "&it_code_sch=" + it_code_sch;
        }
        if (it_nice_number_sch == '' || it_nice_number_sch == null || it_nice_number_sch == 'ì„ íƒ ë° ê²€ìƒ‰') {
        } else {
            query += "&it_nice_number_sch=" + it_nice_number_sch;
        }
        if (it_brand_sch == '' || it_brand_sch == null || it_brand_sch == 'ì„ íƒ ë° ê²€ìƒ‰') {
        } else {
            query += "&it_brand_sch=" + it_brand_sch;
        }
        if (it_item_group_sch == '' || it_item_group_sch == null || it_item_group_sch == 'ì„ íƒ ë° ê²€ìƒ‰') {
        } else {
            query += "&it_item_group_sch=" + it_item_group_sch;
        }
        if (it_division_sch == '' || it_division_sch == null || it_division_sch == 'ì„ íƒ ë° ê²€ìƒ‰') {
        } else {
            query += "&it_div_sch=" + it_division_sch;
        }

        let multiSearch = $("#multiSearch").val()
        if (multiSearch !=='') query += '&total_search=' + multiSearch;

        //console.log(query);
        {#loading_start();#}
        api_gp("/basic_information/items_read/" + query, "GET", {}, (done) => {
            //console.log(done);
            {#loading_finish();#}
            draw_items_table(done);
        });
    }


    function draw_items_table(done) {
        main_table.rows().remove().draw();

        main_table.rows.add(formatData(done.results)).draw();



        if (item_id_idx != null) {
            $("#" + item_id_idx).addClass('clicked');
        }

        $('#item_tbody > tr').on('click', function () {
            let data = main_table.row(this).data();

            setRowColor(this, 'M');


            item_id_idx = data[18];
            item_name = data[2];

            $("#detail_item [name='item_master_code']").val(data[1]);
            $("#detail_item [name='item_master_name']").val(data[2]);
            $("#detail_item [name='item_master_detail']").val(data[3]);
            let option = new Option(data[6], data[7], true, true); //ìì¬êµ¬ë¶„
            $("#id_it_division_add").append(option).trigger('change');

            option = new Option(data[4], data[5], true, true); //ëª¨ë¸
            $("#id_it_model_add").append(option).trigger('change');

            option = new Option(data[8], data[9], true, true); //ë‹¨ìœ„
            $('#id_it_unit_add').append(option).trigger('change');

            option = new Option(data[10], data[11], true, true); //ê±°ë˜ì²˜
            $('#id_it_customer_add').append(option).trigger('change');

            $("#detail_item [name='item_master_moq']").val(data[12]);
            $("#detail_item [name='item_master_safe_amount']").val(data[13]);

            $("#detail_item [name='item_master_standard_price']").val(data[15]);// í‘œì¤€ë‹¨ê°€
            $("#detail_item [name='item_master_fee_rate']").val(data[16]);// ìˆ˜ìˆ˜ë£Œìœ¨
            $("#detail_item [name='item_master_etc']").val(data[14]);// ë¹„ê³ 

            $("#qr").val(data[19]);// qr


            item_qr_path = $(this).find("[data-item='qr']").text();

            // ë²„íŠ¼ í™œì„±í™”
            $("#item_add-sm-4").prop('disabled', true).attr("class","btn btn-primary mr-3 disabled").off('click');

            $("#item_edit-sm-4").prop('disabled', false).attr("class","btn btn-primary mr-3").off('click').on('click', function (){item_edit()});
            $("#item_delete-sm-4").prop('disabled', false).attr("class","btn btn-primary mr-3").off('click').on('click', function (){item_remove()});
        });
    }

    function qr_update() {
        if (!item_id_idx) {
            alert('í’ˆëª©ì„ ì„ íƒí•´ ì£¼ì„¸ìš”.');
            return;
        }

        let data = {
            csrfmiddlewaretoken: '{{ csrf_token }}',
            pk: item_id_idx,
        }

        api_gp('/basic_information/items_qr_update/', 'post', data, (done) => {
            alert('QR ìƒì„±ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.');
            search();

            $("#qr").val(done.qr_path);

        });

        {% comment %}
        api_item_update_qr(item_id_idx, (done) => {
            alert('QR ìƒì„±ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.');
            search();
            //refresh();
        });
        {% endcomment %}
    }


    function item_add() {
        if ($("#detail_item [name='item_master_code']").val() == "") {
            alert("í’ˆë²ˆì„ ì…ë ¥í•´ ì£¼ì„¸ìš”.");
            return;
        }

        if ($("#detail_item [name='item_master_name']").val() == "") {
            alert("í’ˆëª…ì„ ì…ë ¥í•´ ì£¼ì„¸ìš”.");
            return;
        }

        let data = get_data();
        console.log(data)
        api_gp("/basic_information/items_create/", "POST", data, (done) => {
            nation1.page = 1;
            item_id_idx = done.id;
            item_name = done.name;

            alert("ì¶”ê°€í•˜ì˜€ìŠµë‹ˆë‹¤.");

            search();
            $("#qr").val(done.qr_path);
        });
    }


    function item_edit() {
        if (item_id_idx == null) {
            alert("ìˆ˜ì •í•  í–‰ì„ ì„ íƒí•´ ì£¼ì„¸ìš”.");
            return;
        }

        if ($('#code').val() == "") {
            alert("í’ˆë²ˆì„ ì…ë ¥í•´ ì£¼ì„¸ìš”.");
            return;
        }

        if ($('#name').val() == "") {
            alert("í’ˆëª…ì„ ì…ë ¥í•´ ì£¼ì„¸ìš”.");
            return;
        }

        let data = get_data();


        api_gp('/basic_information/items_update/', 'post', data, (done) => {
            alert("ìˆ˜ì •í–ˆìŠµë‹ˆë‹¤..");

            search();

        });
    }


    function item_remove() {
        if (item_id_idx == null) {
            alert("ì‚­ì œí•  í’ˆëª©ì„ ì„ íƒí•´ ì£¼ì„¸ìš”.");
            return;
        }

        if ($('#bom_division').val() == "BOM") {
            alert("[BOM TYPE]ì€ [BOM ê´€ë¦¬] > [BOM í˜•ì‹ ìƒì„±]ì—ì„œ ì‚­ì œí•˜ì„¸ìš”.");
            return;
        }

        let allData = {
            csrfmiddlewaretoken: '{{ csrf_token }}',
            pk: item_id_idx,
            qr_path: item_qr_path,// pk
        }

        let del = confirm(
            "í’ˆëª©: " + item_name + "ì„(ë¥¼) ì‚­ì œ í•˜ì‹œê² ìŠµë‹ˆê¹Œ?"
        );

        if (del) {
            api_gp('/basic_information/items_delete/', 'post', allData, (done_callback) => {
                alert("ì‚­ì œí•˜ì˜€ìŠµë‹ˆë‹¤.");
                nation1.page = 1;

                refresh_data();
                search();

            });
        }
    }

    function show_qr_print(_imgurl) {

        var url = "/material/qr_print/?param1=";
        url = url + _imgurl;
        var name = "QR Print";
        var option = "width=1000px, height=1000px, location=no";
        window.open(url, name, option);

    }

    function api_item_update_qr(id_data, done_callback) {
        $.ajax({
            type: "POST",
            url: "/basic_information/items_qr_update/",
            headers: {
                "Authorization": get_token()
            },
            data: {
                id: id_data
            },
        })
            .done(function (json) {
                done_callback(json);
            })
            .fail(handle_error);
    }


    function get_data() {

        return {
            csrfmiddlewaretoken: '{{ csrf_token }}',
            pk: item_id_idx,

            code: $("#detail_item [name='item_master_code']").val(),  // í’ˆë²ˆ
            name: $("#detail_item [name='item_master_name']").val(),  // í’ˆëª…
            detail: $("#detail_item [name='item_master_detail']").val(),  // í’ˆëª…ìƒì„¸

            item_division: $('#id_it_division_add').val(),  // ìì¬ë¶„ë¥˜
            unit: $('#id_it_unit_add').val(),  // ë‹¨ìœ„
            model: $('#id_it_model_add').val(),  // ëª¨ë¸

            purchase_from: $('#id_it_customer_add').val(), // ê±°ë˜ì²˜


            etc: $("#detail_item [name='item_master_etc']").val(),  // ë¹„ê³ 
            standard_price: $("#detail_item [name='item_master_standard_price']").val(),  // í‘œì¤€ë‹¨ê°€

            safe_amount: $("#detail_item [name='item_master_safe_amount']").val(),
            fee_rate: $("#detail_item [name='item_master_fee_rate']").val(),

            qr_path: ''
        };
    }

    // êµ³ì´?
    function refresh_search_data() {
        $("#code_sch").val("");
        $("#name_sch").val("");
        //$("#division_sch").val(null).trigger("change");
    }


    function refresh_data() {
            item_id_idx = null;
            item_name = null;

            $("#detail_item [name='item_master_code']").val("");
            $("#detail_item [name='item_master_name']").val("");
            $("#detail_item [name='item_master_detail']").val("");
            let option = new Option("", "", true, true); //ìì¬êµ¬ë¶„
            $("#id_it_division_add").append(option).trigger('change');

            option = new Option("", "", true, true); //ëª¨ë¸
            $("#id_it_model_add").append(option).trigger('change');

            option = new Option("", "", true, true); //ë‹¨ìœ„
            $('#id_it_unit_add').append(option).trigger('change');

            option = new Option("", "", true, true); //ê±°ë˜ì²˜
            $('#id_it_customer_add').append(option).trigger('change');

            $("#detail_item [name='item_master_moq']").val("");

            $("#detail_item [name='item_master_standard_price']").val("");// í‘œì¤€ë‹¨ê°€
            $("#detail_item [name='item_master_fee_rate']").val("");// ìˆ˜ìˆ˜ë£Œìœ¨
            $("#detail_item [name='item_master_etc']").val("");// ë¹„ê³ 

            $("#qr").val("");// qr


            item_qr_path = null;

            item_id_idx = null;
             $('#item_tbody').find('tr').siblings().css('background-color', '');


        // ë²„íŠ¼ í™œì„±í™”
        $("#item_add-sm-4").prop('disabled', false).attr("class","btn btn-primary mr-3").off('click').on('click', function (){item_add()})

        $("#item_edit-sm-4").prop('disabled', true).attr("class","btn btn-primary mr-3 disabled").off('click')
        $("#item_delete-sm-4").prop('disabled', true).attr("class","btn btn-primary mr-3 disabled").off('click')
    }

    function formatData(results) {

          return results.map((result, index) => [
            index+1,
            result.code,
            result.name,
            result.detail,
            result.model_name,
            result.model_id,
            result.division_name,
            result.division_id,
            result.unit_name,
            result.unit_id,
            result.purchase_from_name,
            result.purchase_from_id,
            result.moq,
            result.safe_amount,
            result.etc,
            result.standard_price,
            result.fee_rate,
            result.type_name,
            result.id,
            result.qr_path
          ]);
        }

</script>

</body>
</html>
