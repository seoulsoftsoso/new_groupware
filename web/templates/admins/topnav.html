{% load static %}
<style>
    body {
        background-color: #ffffff !important;
    }

    /* 툴팁 말풍선 */
    .tooltip_top, .tooltip_bottom, .tooltip_br, .tooltip_tr, .tooltip_tl {
        position: relative;
    }

    .tooltip_top::after {
        content: attr(data-tooltip);
        position: absolute;
        bottom: 110%;
        left: 50%;
        transform: translateX(-50%);
        background-color: #333;
        color: #fff;
        font-size: 14px !important;
        padding: 6px 10px 6px 10px;
        border-radius: 6px !important;;
        white-space: pre;
        opacity: 0;
        visibility: hidden;
        transition: opacity 0.5s ease;
        z-index: 9999 !important;
    }

    .tooltip_bottom::after {
        content: attr(data-tooltip);
        position: absolute;
        top: 110%;
        left: 50%;
        transform: translateX(-50%);
        background-color: #333;
        color: #fff;
        font-size: 14px !important;
        padding: 6px 10px 6px 10px;
        border-radius: 6px !important;;
        white-space: pre;
        opacity: 0;
        visibility: hidden;
        transition: opacity 0.5s ease;
        z-index: 9999 !important;
    }

    .tooltip_br::after {
        content: attr(data-tooltip);
        position: absolute;
        top: 110%;
        left: 200%;
        transform: translateX(-50%);
        background-color: #333;
        color: #fff;
        font-size: 14px !important;
        padding: 6px 10px 6px 10px;
        border-radius: 6px !important;;
        white-space: pre;
        opacity: 0;
        visibility: hidden;
        transition: opacity 0.5s ease;
        z-index: 9999 !important;
    }
    
    .tooltip_tr::after {
        content: attr(data-tooltip);
        position: absolute;
        bottom: 110%;
        left: 0;
        transform: translateX(0%);
        background-color: #333;
        color: #fff;
        font-size: 14px !important;
        padding: 6px 10px 6px 10px;
        border-radius: 6px !important;;
        white-space: pre;
        opacity: 0;
        visibility: hidden;
        transition: opacity 0.5s ease;
        z-index: 9999 !important;
    }
    
    .tooltip_tl::after {
        content: attr(data-tooltip);
        position: absolute;
        bottom: 110%;
        left: 100%;
        transform: translateX(-100%);
        background-color: #333;
        color: #fff;
        font-size: 14px !important;
        padding: 6px 10px 6px 10px;
        border-radius: 6px !important;;
        white-space: pre;
        opacity: 0;
        visibility: hidden;
        transition: opacity 0.5s ease;
        z-index: 9999 !important;
    }
    
    /* 호버 시 툴팁 보이기 */
    .tooltip_top:hover::after, .tooltip_bottom:hover::after, .tooltip_br:hover::after, .tooltip_tr:hover::after, .tooltip_tl:hover::after {
        opacity: 1;
        visibility: visible;
    }

    /* 부트스트랩 툴팁 */
    .tooltip-inner {
        font-size: 12px; /* 글자 크기 작게 */
        background-color: #000; /* 회색 배경색 */
    }
    .tooltip {
        margin-top: 15px !important;
        margin-bottom: 15px !important;
    }


    @media (max-width: 900px) {
        #page-topbar {
            transform: scale(0.75) !important; /* 페이지를 60% 크기로 축소 */
            transform-origin: top right !important; /* 축소할 기준점을 오른쪽 상단으로 설정 */
            width: 150% !important; /* 가로 크기를 늘려서 공간을 채움 */
            position: fixed !important; /* 화면의 고정된 위치에 배치 */
            top: 0 !important; /* 화면 최상단에 위치 */
            right: 0 !important; /* 화면의 오른쪽에 위치 */
            z-index: 9999 !important; /* 다른 요소들 위에 나타나도록 z-index 설정 */
        }

        .userinfo_area {
            padding: 0 !important;
        }
    }
</style>
{#<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">#}
{#<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>#}
{#<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>#}
{#<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>#}
<header id="page-topbar">
    <div class="navbar-header layout-navbar d-flex justify-content-between align-items-center p-0">
        <div class="d-flex justify-content-start align-items-center px-3">
            {#            왼쪽 공간#}
        </div>
        <div class="userinfo_area d-flex justify-content-end align-items-center px-3">
            {% comment %}<div class="dropdown d-inline-block">
                <button type="button" class="btn header-item noti-icon waves-effect p-2"
                        id="notiCenter" data-bs-toggle="dropdown" aria-haspopup="true"
                        aria-expanded="false" style="position: relative;">
                    <i class="bx bx-bell" style="font-size: 36px;"></i>
                    <span class="badge bg-danger rounded-pill" id="notiCount"
                          style="position: absolute; top: 5px; right: 5px; font-size: 10px;"></span>
                </button>
                <div class="dropdown-menu dropdown-menu-lg dropdown-menu-end p-0"
                     aria-labelledby="page-header-notifications-dropdown">
                    <div class="p-3">
                        <div class="row align-items-center">
                            <div class="col">
                                <h6 class="m-0" key="t-notifications"> 알림창 </h6>
                            </div>
                            <div class="col-auto">
                                <a href="#!" class="small" key="t-view-all"> 모두 보기</a>
                            </div>
                        </div>
                    </div>

                    <div data-simplebar style="height: auto; width: 400px; margin: 0 20px 10px 20px;">
                        <a href="javascript: void(0);" class="text-reset notification-item p-2">
                            <div class="d-flex">
                                <div class="avatar-xs me-3">
                                    <span class="avatar-title bg-primary rounded-circle font-size-16">
                                        <i class="bx bx-cart"></i>
                                    </span>
                                </div>
                                <div class="flex-grow-1">
                                    <h6 class="mb-1" key="t-your-order">전자결재 기능개발 중</h6>
                                    <div class="font-size-12 text-muted">
                                        <p class="mb-1" key="t-grammer">결재 상태의 업데이트를 알려줄 알림창입니다.</p>
                                        <p class="mb-0"><i class="mdi mdi-clock-outline"></i> <span
                                                key="t-min-ago">2024-07-01 오후 3:30</span></p>
                                    </div>
                                </div>
                            </div>
                        </a>
                        <a href="javascript: void(0);" class="text-reset notification-item p-2">
                            <div class="d-flex">
                                <div class="avatar-xs me-3">
                                    <span class="avatar-title bg-primary rounded-circle font-size-16">
                                        <i class="bx bx-cart"></i>
                                    </span>
                                </div>
                                <div class="flex-grow-1">
                                    <h6 class="mb-1">결재문서 [AP240701-008] 완료</h6>
                                    <div class="font-size-12 text-muted">
                                        <p class="mb-1" key="t-simplified">'[휴가신청서] 개발1팀 슈퍼맨 240701'의 결재가 완료되었습니다.</p>
                                        <p class="mb-0"><i class="mdi mdi-clock-outline"></i> <span
                                                key="t-hours-ago">2024-07-03 오전 10:22</span></p>
                                    </div>
                                </div>
                            </div>
                        </a>
                        <a href="javascript: void(0);" class="text-reset notification-item p-2">
                            <div class="d-flex">
                                <div class="avatar-xs me-3">
                                    <span class="avatar-title bg-success rounded-circle font-size-16">
                                        <i class="bx bx-badge-check"></i>
                                    </span>
                                </div>
                                <div class="flex-grow-1">
                                    <h6 class="mb-1" key="t-shipped">결재문서 [AP240702-002] 반려</h6>
                                    <div class="font-size-12 text-muted">
                                        <p class="mb-1" key="t-grammer">'[휴가신청서] 개발1팀 슈퍼맨 240702'의 결재가 반려되었습니다.</p>
                                        <p class="mb-0"><i class="mdi mdi-clock-outline"></i> <span
                                                key="t-min-ago">2024-07-03 오전 10:22</span></p>
                                    </div>
                                </div>
                            </div>
                        </a>
                    </div>

                    <div class="p-2 border-top d-grid">
                        <a class="btn btn-sm btn-link font-size-14 text-center" href="javascript:void(0)">
                            <i class="mdi mdi-arrow-right-circle me-1"></i> <span key="t-view-more">더 보기</span>
                        </a>
                    </div>
                </div>
            </div>{% endcomment %}

            <div class="d-flex justify-content-end align-items-center mx-2" id="currentDateTime" style="font-size: 14px; font-weight: bold; color: #444;">loading..</div>

            <div class="d-flex justify-content-end align-items-center mx-2 my-0" style="font-size: 26px; color: #ccc;">|</div>

            <button class="fa-regular fa-bell-slash fa-xl mx-1"
                    style="color: #444; background-color: transparent; border: none;" type="button"
                    data-bs-toggle="tooltip" data-bs-placement="bottom" data-bs-title="알림 기능 추후 업데이트 예정"></button>

            <button class="fa-solid fa-expand fa-xl mx-1"
                    style="color: #444; background-color: transparent; border: none;" id="fullscreen"
                    data-bs-toggle="tooltip" data-bs-placement="bottom" data-bs-title="전체화면 전환"
                    type="button" onclick="fs_toggle_click();"></button>

            <div class="d-flex justify-content-end align-items-center mx-1 my-0" style="font-size: 26px; color: #ccc; margin-left: 14px !important;">|</div>

            <div class="dropdown d-inline-block">
                <button type="button" class="btn header-item waves-effect" id="page-header-user-dropdown"
                        data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    {% if request.user.profile_image %}
                        <img src="/data/{{ request.user.profile_image }}" style="width: 40px; height: 40px; border-radius: 100%;" alt="profile_image">
                    {% else %}
                        <i class='bx bxs-user-circle' style='font-size: 36px;'></i>
                    {% endif %}
                    <div class="mt-1 mx-2" id="username" style="font-size: 14px; font-weight: bold; color: #444;">
                        <div class="d-flex justify-content-start">{{ request.user.department_position.name }}</div>
                        <div class="d-flex justify-content-start">{{ request.user.username }} 님</div>
                    </div>
                    <i class="fa-solid fa-chevron-down"></i>
                </button>
                <div class="dropdown-menu dropdown-menu-end">
                    <!-- item-->
                    <a class="dropdown-item d-flex" href="{% url 'userSettingsPage' %}" style="font-weight: bold; color: #444;">
                        <span key="t-profile"><i class="fa-solid fa-user-gear fa-lg me-2"></i>{{ request.user.username }} 님</span></a>
                    {% comment %}<a class="dropdown-item" href="#"><i
                            class="bx bx-wallet font-size-16 align-middle me-1"></i> <span
                            key="t-my-wallet">My Wallet</span></a>
                    <a class="dropdown-item d-block" href="#"><span
                            class="badge bg-success float-end">11</span><i
                            class="bx bx-wrench font-size-16 align-middle me-1"></i> <span key="t-settings">Settings</span></a>
                    <a class="dropdown-item" href="#"><i
                            class="bx bx-lock-open font-size-16 align-middle me-1"></i> <span
                            key="t-lock-screen">Lock screen</span></a>{% endcomment %}
                    <div class="dropdown-divider m-1"></div>
                    <a class="dropdown-item d-flex text-danger" href="{% url 'logout' %}" style="font-weight: bold; color: red;">
                        <span key="t-logout"><i class="fa-solid fa-power-off fa-lg me-2"></i>&nbsp;로그아웃</span></a>
                </div>
            </div>
        </div>
    </div>
</header>

<script>
    $("#logout").click(function () {
        flush_token();
        window.location.href = "/logout/";
    });

    function flush_token() {
        document.cookie = 'Authorization=; path=/; expires=Thu, 01 Jan 1970 00:00:01 GMT;';
        document.cookie = 'user_id=; path=/; expires=Thu, 01 Jan 1970 00:00:01 GMT;';
        document.cookie = 'username=; path=/; expires=Thu, 01 Jan 1970 00:00:01 GMT;';
        document.cookie = 'is_superuser=; path=/; expires=Thu, 01 Jan 1970 00:00:01 GMT;';
        document.cookie = 'is_master=; path=/; expires=Thu, 01 Jan 1970 00:00:01 GMT;';
        document.cookie = 'is_active=; path=/; expires=Thu, 01 Jan 1970 00:00:01 GMT;';
        document.cookie = 'permissions=; path=/; expires=Thu, 01 Jan 1970 00:00:01 GMT;';
        document.cookie = 'enterprise_id=; path=/; expires=Thu, 01 Jan 1970 00:00:01 GMT;';
        document.cookie = 'enterprise_name=; path=/; expires=Thu, 01 Jan 1970 00:00:01 GMT;';
        document.cookie = 'order_company=; path=/; expires=Thu, 01 Jan 1970 00:00:01 GMT;';
    }

    {% comment %}document.addEventListener("DOMContentLoaded", function () {
        let notiCount = document.getElementById("notiCount").textContent.trim();
        let notiCenter = document.getElementById("notiCenter");

        if (notiCount !== "") {
            notiCenter.classList.add("bx-tada");
        } else {
            notiCenter.classList.remove("bx-tada");
        }
    });{% endcomment %}


    function fs_toggle_click() {
        const elem = document.documentElement;
        const btn = document.getElementById('fullscreen');

        if (!document.fullscreenElement) {
            if (elem.requestFullscreen) {
                elem.requestFullscreen();
            } else if (elem.mozRequestFullScreen) { // Firefox
                elem.mozRequestFullScreen();
            } else if (elem.webkitRequestFullscreen) { // Chrome, Safari and Opera
                elem.webkitRequestFullscreen();
            } else if (elem.msRequestFullscreen) { // IE/Edge
                elem.msRequestFullscreen();
            }
            btn.classList.remove('fa-expand');
            btn.classList.add('fa-compress');
        } else {
            if (document.exitFullscreen) {
                document.exitFullscreen();
            } else if (document.mozCancelFullScreen) { // Firefox
                document.mozCancelFullScreen();
            } else if (document.webkitExitFullscreen) { // Chrome, Safari and Opera
                document.webkitExitFullscreen();
            } else if (document.msExitFullscreen) { // IE/Edge
                document.msExitFullscreen();
            }
            btn.classList.remove('fa-compress');
            btn.classList.add('fa-expand');
        }
    }

    document.getElementById('fullscreen').addEventListener('click', fs_toggle_click);
    document.addEventListener('fullscreenchange', (event) => {
        const btn = document.getElementById('fullscreen');
        if (!document.fullscreenElement) {
            btn.classList.remove('fa-compress');
            btn.classList.add('fa-expand');
        }
    });


    function updateTime() {
        let currentDateTimeElement = document.getElementById('currentDateTime');
        let now = new Date();

        let year = now.getFullYear();
        let month = ('0' + (now.getMonth() + 1)).slice(-2);
        let date = ('0' + now.getDate()).slice(-2);
        let hours = ('0' + now.getHours()).slice(-2);
        let minutes = ('0' + now.getMinutes()).slice(-2);
        let seconds = ('0' + now.getSeconds()).slice(-2);

        let calendarIcon = '<i class="fa-regular fa-calendar-days" style="margin-right: 4px;"></i>';
        let clockIcon = '<i class="fa-regular fa-clock" style="margin: 0 4px 0 16px;"></i>';

        let formattedTime = `${calendarIcon} ${year}-${month}-${date} ${clockIcon} ${hours}:${minutes}:${seconds}`;

        currentDateTimeElement.innerHTML = formattedTime;
    }

    updateTime();
    setInterval(updateTime, 1000);
</script>
