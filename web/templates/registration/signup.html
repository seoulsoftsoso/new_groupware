{% load static %}
{% include 'admins/admin_header.html' %}
<link rel="stylesheet" href="{% static 'sneat/assets/vendor/css/pages/page-auth.css' %}" />
<style>
@font-face {
    font-family: 'Pretendard';
    src: url("{% static 'admin/fonts/Pretendard-Medium.woff' %}") format('woff');
}
</style>
{% if user.is_active %}
<script>history.back(-1);</script>
{% else %}

    <div class="authentication-wrapper authentication-cover">
        <div class="authentication-inner row m-0 d-flex justify-content-center">
            <!-- /Left Text -->
            <div class="d-flex align-items-center justify-content-center" style="height: 100vh;">

                    <div class="w-80 d-flex justify-content-center" style="height: 880px; box-shadow: 12px 12px 25px 0px rgba(0, 0, 0, 0.12); border-radius: 36px;">
                    <img
                            src="{% static 'img/signup_img.png' %}"
                            class="img-fluid"
                            style="border-top-left-radius: 36px; border-bottom-left-radius: 36px;"
                            alt="Login image"
                            width="800"
                            data-app-dark-img="illustrations/girl-with-laptop-dark.png"
                            data-app-light-img="illustrations/girl-with-laptop-light.png"/>

                    <div class="d-flex col-12 col-lg-7 col-xl-6 align-items-center authentication-bg p-sm-5 p-4"
                         style="border-top-right-radius: 36px; border-bottom-right-radius: 36px;">
                        <div class="w-px-500 mx-auto" style="">
                            <h3 class="mb-2" style="color: #000;font-family: Pretendard;font-size: 36px;font-style: normal;font-weight: 300;line-height: normal;">회원 가입을 위해</h3>
                            <h2 class="mb-4" style="color: #000;font-family: Pretendard;font-size: 36px;font-style: normal;font-weight: 700;line-height: normal;">정보를 입력해주세요</h2>

                            <p>
                                <span>이미 회원이신가요?</span>
                                <a href="{% url 'loginPage' %}">
                                    <span>로그인</span>
                                </a>
                            </p>

                            <form action="{% url 'UserCreate' %}" method="post" style="margin-top: 30px;">
                                {% csrf_token %}
                                {{ form }}
                                <!-- 이름 필드 -->
                                <div class="form-group row mb-4">
                                    <label for="id_username" class="col-sm-2 col-form-label"><span
                                            class="critical">* </span>이름</label>
                                    <div class="col-sm-10">
                                        <input type="text" name="username" id="id_username" class="form-control"
                                               placeholder="이름을 입력해주세요." required>
                                    </div>
                                </div>

                                <div class="form-group row mb-4">
                                    <label for="id_user_id" class="col-sm-2 col-form-label"><span
                                            class="critical">* </span>
                                        아이디</label>
                                    <div class="col-sm-10" style="display: flex">
                                        <input type="text" name="user_id" id="id_user_id" class="form-control"
                                               style="width: 300px; " placeholder="아이디를 입력해주세요." required>
                                        <button type="button" id="check-duplicate" class="btn btn-label-warning"
                                                style="width: 110px;">중복확인
                                        </button>
                                    </div>
                                </div>


                                <div class="form-group row mb-4">
                                    <label for="id_password1" class="col-sm-2 col-form-label"><span
                                            class="critical">* </span>
                                        비밀번호</label>
                                    <div class="col-sm-10">
                                        <input type="password" name="password" id="id_password1" class="form-control"
                                               placeholder="비밀번호는 최소 8자 이상이어야 합니다." minlength="8" required>
                                    </div>
                                </div>

                                <div class="form-group row mb-4">
                                    <label for="id_password2" class="col-sm-2 col-form-label"><span
                                            class="critical">* </span> 비밀번호 확인</label>
                                    <div class="col-sm-10">
                                        <input type="password" name="password2" id="id_password2" class="form-control" style="margin-top: 6px;"
                                               placeholder="확인을 위해 이전과 동일한 비밀번호를 입력하세요." minlength="8" required
                                               oninput="checkPasswordMatch()">
                                        <p id="password-match-message" style="color: red;"></p>
                                    </div>
                                </div>

                                <div class="form-group row mb-4" style="margin-top: -7px;">
                                    <label for="id_email" class="col-sm-2 col-form-label"><span
                                            class="critical">* </span> 이메일</label>
                                    <div class="col-sm-10">
                                        <input type="email" name="email" id="id_email" class="form-control"
                                               placeholder="foo@bar.com 형식으로 입력하세요." required>
                                    </div>
                                </div>

                                <div class="form-group row mb-4">
                                    <label for="id_useremailreceive" class="col-sm-2 col-form-label">이메일 수신 여부</label>
                                    <div class="col-sm-10" style="padding-top: 5px">
                                        <label class="form-check-label chk_text" for="same-address"
                                               style="cursor: pointer;">개인정보 수집 및 이용, 마케팅 목적의 광고성 정보 수신에 동의합니다.<input type="checkbox" style="width: 13px; height: 13px; margin-left: 10px;" name="useremailreceive" id="id_useremailreceive"></label>
                                    </div>
                                </div>

                                <div class="form-group row">
                                    <label for="id_userintro" class="col-sm-2 col-form-label">소개</label>
                                    <div class="col-sm-10">
                                        <textarea name="userintro" id="id_userintro" class="form-control" rows="3"
                                                  placeholder="만나서 반갑습니다."></textarea>
                                    </div>
                                </div>

                                <div class="form-group row" style="margin-top: 30px;">
                                    <div class="mb-3">
                                        <button type="submit" id="signup_btn" class="btn btn-primary d-grid w-100"
                                                style="width: 400px;">회원가입
                                        </button>
                                    </div>
                                </div>
                            </form>
                        </div>

                        </div>
                    </div>

                </div>
            </div>
        </div>

    </div>


<script>
    function checkPasswordMatch() {
        var password1 = document.getElementById("id_password1").value;
        var password2 = document.getElementById("id_password2").value;
        var message = document.getElementById("password-match-message");

        if (password1 !== password2) {
            message.innerHTML = "비밀번호가 일치하지 않습니다.";
        } else {
            message.innerHTML = "";
        }
    }
</script>
<script>
    $("#check-duplicate").click(function() {
    var userId = $("#id_user_id").val();
    var csrfToken = $('[name=csrfmiddlewaretoken]').val();
    $.ajax({
        url: "/check-duplicate/",
        method: "POST",
        data: {
            user_id: userId,
            csrfmiddlewaretoken: csrfToken
        },
        success: function(response) {
            if (response.is_duplicate) {
                alert("이미 사용 중인 아이디입니다.");
            } else {
                alert("사용 가능한 아이디입니다.");
            }
        },
        error: function() {
            console.error("중복 확인 중 오류가 발생했습니다.");
        }
    });
});
</script>
<script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
<script>
    $(document).ready(function () {
        $("#signup_btn").click(function () {
            var isFormValid = validateForm();

            if (isFormValid) {
                alert('회원가입이 완료되었습니다.');
            } else {
                alert('필수 항목을 입력하세요.');
            }
        });
    });

    function validateForm() {
        var requiredFields = ["id_username", "id_user_id", "id_password1", "id_password2", "id_email"];
        for (var i = 0; i < requiredFields.length; i++) {
            var fieldId = requiredFields[i];
            var fieldValue = $("#" + fieldId).val();
            if (!fieldValue) {
                return false;
            }
        }
        return true;
    }
</script>
{% endif %}
{% include 'footer.html' %}